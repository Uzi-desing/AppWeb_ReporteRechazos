{% extends "navegacion.html" %}
{% load static %}
{% block content %}

<h1 class="text-2xl font-semibold tracking-tight mb-6">Listado de Reportes</h1>

<div class="flex flex-col gap-y-4 md:flex-row md:items-center md:justify-between mb-6 p-4 rounded-lg border border-black/10 bg-white shadow-sm w-full">
    <!-- Filtros por fecha -->
    <div class="flex flex-col gap-y-3 md:flex-row md:items-center md:gap-x-4 w-full">
        <p class="text-sm font-medium text-black/80">Filtrar por Fecha:</p>
        <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
            <input type="date" id="fechaDesde" class="border border-black/20 rounded-md p-2 text-sm focus:border-brand focus:ring-brand outline-none transition-colors w-full sm:w-auto">
            <input type="date" id="fechaHasta" class="border border-black/20 rounded-md p-2 text-sm focus:border-brand focus:ring-brand outline-none transition-colors w-full sm:w-auto">
        </div>

        <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
            <button id="filtrarFechas"
                class="rounded-md border border-black px-4 py-2 text-sm font-medium text-black hover:bg-brand hover:border-brand hover:text-white transition-colors w-full sm:w-auto">
                Filtrar
            </button>
            <button id="limpiarFiltros"
                class="rounded-md border border-black/20 px-4 py-2 text-sm font-medium text-black/70 hover:bg-black/10 transition-colors w-full sm:w-auto">
                Quitar
            </button>
        </div>
    </div>

    <!-- Buscador -->
    <div class="w-full md:w-[250px]">
        <label for="buscador" class="sr-only">Buscar:</label>
        <div class="relative">
            <input type="text" id="buscador" placeholder="Buscar por cualquier campo..."
                class="border border-black/20 rounded-md py-2 pl-10 pr-4 text-sm w-full focus:border-brand focus:ring-brand outline-none transition-colors">
            <i data-lucide="search" class="w-4 h-4 text-black/50 absolute left-3 top-1/2 transform -translate-y-1/2"></i>
        </div>
    </div>
</div>

<!-- Tabla -->
<div class="overflow-x-auto w-full rounded-lg border border-black/10 shadow-md">
    <table id="tablaReportes" class="min-w-full divide-y divide-black/10 bg-white">
        <thead>
            <tr class="bg-black/5 select-none">
                <th data-ordenable="true" data-col-index="0" class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-black/80 uppercase tracking-wider cursor-pointer hover:bg-black/10 transition-colors group">
                    <div class="flex items-center justify-between">
                        <span>N° Reporte</span>
                        <span class="sort-indicator ml-2 text-black/40 group-hover:text-black/60">⇅</span>
                    </div>
                </th>
                <th class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-black/80 uppercase tracking-wider">Fecha</th>
                <th data-ordenable="true" data-col-index="2" class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-black/80 uppercase tracking-wider cursor-pointer hover:bg-black/10 transition-colors group">
                    <div class="flex items-center justify-between">
                        <span>Cliente</span>
                        <span class="sort-indicator ml-2 text-black/40 group-hover:text-black/60">⇅</span>
                    </div>
                </th>
                <th data-ordenable="true" data-col-index="3" class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-black/80 uppercase tracking-wider cursor-pointer hover:bg-black/10 transition-colors group">
                    <div class="flex items-center justify-between">
                        <span>Obra</span>
                        <span class="sort-indicator ml-2 text-black/40 group-hover:text-black/60">⇅</span>
                    </div>
                </th>
                <th data-ordenable="true" data-col-index="4" class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-black/80 uppercase tracking-wider cursor-pointer hover:bg-black/10 transition-colors group">
                    <div class="flex items-center justify-between">
                        <span>Remito</span>
                        <span class="sort-indicator ml-2 text-black/40 group-hover:text-black/60">⇅</span>
                    </div>
                </th>
                <th data-ordenable="true" data-col-index="5" class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-black/80 uppercase tracking-wider cursor-pointer hover:bg-black/10 transition-colors group">
                    <div class="flex items-center justify-between">
                        <span>Empleado a Cargo</span>
                        <span class="sort-indicator ml-2 text-black/40 group-hover:text-black/60">⇅</span>
                    </div>
                </th>
            </tr>
        </thead>
        <tbody class="divide-y divide-black/5" id="tablaBody">
            {% for reporte in reportes %}
            <tr class="hover:bg-brand/5 transition-colors cursor-pointer reporte-row" data-url="{% url 'detalle_reporte' reporte.idReporte %}">
                <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm font-medium text-brand">{{ reporte.idReporte }}</td>
                <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-black/90">{{ reporte.fecha|date:"Y-m-d" }}</td>
                <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-black/90">{{ reporte.idCliente.nombre }}</td>
                <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-black/90">{{ reporte.idObra.nombreObra }}</td>
                <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-black/90">{{ reporte.remitoRecepcion }}</td>
                <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-black/90">{{ reporte.idEmpleado }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="paginacion" class="mt-6 flex justify-center items-center gap-2 text-sm"></div>

<p id="mensajeNoResultados" class="mt-4 text-sm text-red-600 font-medium flex items-center" style="display: none;">
    <i data-lucide="alert-triangle" class="w-4 h-4 mr-1 inline-block"></i>
    Su reporte no se ha encontrado.
</p>

{% endblock %}

{% block js %}
<script src="{% static 'js/tabla_reportes.js' %}"></script>
{% endblock %}
